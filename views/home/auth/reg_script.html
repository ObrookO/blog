<script>
    function register(obj) {
        let form = $(obj).parents('#reg-form'),
            username = form.find('input[name=username]').val(),
            password1 = form.find('input[name=password1]').val(),
            password2 = form.find('input[name=password2]').val(),
            token = form.find('input[name=_xsrf]').val();

        $.ajax({
            url: '{{ urlfor "AuthController.DoRegister" }}',
            type: 'post',
            dataType: 'json',
            data: {
                _xsrf: token,
                username: username,
                password1: password1,
                password2: password2
            },
            success: function (data) {
                if (data.code != 200) {
                    $('.error').text(data.msg);
                } else {
                    window.location.href = '{{ urlfor "IndexController.Get" }}'
                }
            }
        })
    }
</script>